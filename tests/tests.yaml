# SpatialCore Test Definitions
# YAML-based test framework for cross-language validation
#
# Structure:
#   - language: python | R
#     module: spatialcore module name
#     function: function name
#     inputs: list of input argument lists
#     expected_outputs: list of expected outputs
#     tolerance: optional float for numeric comparison

tests:
  # Spatial statistics tests
  - language: python
    module: spatial
    function: morans_i
    description: "Moran's I spatial autocorrelation"
    inputs:
      - adata: "fixtures/test_spatial.h5ad"
        gene: "gene_1"
        spatial_key: "spatial"
    expected_outputs:
      - I: 0.45
        p_value: 0.001
    tolerance: 0.01

  - language: python
    module: spatial
    function: lees_l
    description: "Lee's L bivariate spatial correlation"
    inputs:
      - adata: "fixtures/test_spatial.h5ad"
        gene_x: "gene_1"
        gene_y: "gene_2"
        spatial_key: "spatial"
    expected_outputs:
      - L: 0.32
        p_value: 0.01
    tolerance: 0.01

  # R equivalents for cross-language validation
  - language: R
    module: spatial
    function: morans_i
    description: "Moran's I spatial autocorrelation (R)"
    inputs:
      - adata_path: "fixtures/test_spatial.h5ad"
        gene: "gene_1"
        spatial_key: "spatial"
    expected_outputs:
      - I: 0.45
        p_value: 0.001
    tolerance: 0.01

  # Clustering tests
  - language: python
    module: clustering
    function: compute_domains
    description: "Domain identification"
    inputs:
      - adata: "fixtures/test_spatial.h5ad"
        method: "leiden"
        resolution: 0.5
    expected_outputs:
      - n_domains: 5
        key_added: "domain"

  # NMF tests
  - language: python
    module: nmf
    function: spatial_nmf
    description: "Spatial NMF decomposition"
    inputs:
      - adata: "fixtures/test_spatial.h5ad"
        n_components: 10
    expected_outputs:
      - obsm_key: "X_spatial_nmf"
        n_components: 10
